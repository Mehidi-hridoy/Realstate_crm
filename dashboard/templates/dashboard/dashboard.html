{% extends 'crm/base.html' %}

{% block title %}
    Dashboard
{% endblock %}

{% block content %}
<h1>Dashboard</h1>



<div class="row mb-4">
    <!-- Lead Status Summary (Left Column) -->
    <div class="col-md-6">
        <h3>Lead Status Summary</h3>
        <div class="row">
            {% for item in status_summary %}
                <div class="col-md-6 mb-3">
                    <div class="card text-white bg-primary shadow-sm">
                        <div class="card-body text-center">
                            <h5 class="card-title">{{ item.status|capfirst }}</h5>
                            <p class="card-text display-6">{{ item.total }}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Lead Priority Summary (Right Column) -->
    <div class="col-md-6">
        <h3>Lead Priority Summary</h3>
        <div class="row">
            {% for item in priority_summary %}
                <div class="col-md-6 mb-3">
                    <div class="card text-white bg-success shadow-sm">
                        <div class="card-body text-center">
                            <h5 class="card-title">{{ item.priority|capfirst }}</h5>
                            <p class="card-text display-6">{{ item.total }}</p>
                            
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>





<!-- EXISTING LEADS TABLE -->
<h2>Recent Leads</h2>
{% if recent_leads %}
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Name</th>
                <th>Status</th>
                <th>Priority</th>
                <th>Favorite</th>
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            {% for item in recent_leads %}
                <tr>
                    <td>{{ item.name }}</td>
                    <td>{{ item.get_status_display }}</td>
                    <td>{{ item.get_priority_display }}</td>
                    <td>
                        <span class="star-icon" onclick="toggleStar('{{ item.pk }}')">⭐</span>
                    </td>
                    <td><a href="{% url 'lead_details' item.pk %}" class="btn btn-info">Read More</a></td>
                </tr> 
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>No recent leads found.</p>
{% endif %}

<!-- EXISTING CLIENTS TABLE -->
<h2>Recent Clients</h2>
{% if recent_clients %}
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Favorite</th>
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            {% for client in recent_clients %}
                <tr>
                    <td>{{ client.name }}</td>
                    <td>
                        {% if client.get_description_display %}
                            {{ client.get_description_display }}
                        {% else %}
                            {{ client.description }}
                        {% endif %}
                    </td>
                    <td>
                        <span class="star-icon" onclick="toggleStar('{{ client.pk }}')">⭐</span>
                    </td>
                    <td><a href="{% url 'clients_detail' client.pk %}" class="btn btn-info">Read More</a></td>
                </tr> 
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>No recent clients found.</p>
{% endif %}
{% endblock %}
